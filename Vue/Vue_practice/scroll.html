<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Vue Scroll</title>
	<style>
		body{margin:0;color:#fff;background:#333;}
		button{padding:0;background:none;border:none;font-size:inherit;color:inherit;cursor:pointer;}
		button:focus{outline:none}
		.fullpage{display:flex;justify-content:center;align-items:center;width:100%;height:100vh}
		.green{background-color:darkseagreen;}
		.coral{background-color:coral;}
		.blue{background-color:cornflowerblue;}
		.purple{background-color:thistle;}
		.fullpage h1{margin:0;font-size:3em;text-transform:capitalize}
		.btn_wrap{margin:0;padding:0;position:fixed;top:50%;right:25px;transform:translateY(-50%);}
		.btn_wrap li{list-style:none;width:15px;height:15px;}
		.btn_wrap button{display:block;margin:5px;width:10px;height:10px;background-color:#fff;opacity:0.5;transition:.3s;}
		.btn_wrap li.active button{transform:scale(1.5);opacity:1;}
		.btn_wrap2{position:fixed;top:0;left:50%;transform:translateX(-50%);}
		.btn_wrap2 .btn{display:block;width:150px;height:50px;font-size:16px;border:2px solid;background:none;transition:0.25s;}
		.btn_wrap2 .btn{margin-top:20px;border-color:#fff;color:#fff;}
		.btn_wrap2 .btn:hover{box-shadow:0 7px 5px -3px #fff;transform:translateY(-7px);cursor:grabbing}
	</style>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>
	<!-- Practice -->
	<!-- <div id="app" @scroll="pageScroll"> -->
	<div id="app">
		<ul class="btn_wrap">
			<li v-for="(n, index) in num" :class="{ active: index === activeIndex && scrollPosition > test[n] }" @click="activeIndex = index" :data-index="index">
				<button type="button" @click="btnClick"></button>
			</li>
		</ul>
		<component v-for="item in sections" :is="item" :key="item.id"></component>
		<div class="btn_wrap2">
			<button class="btn add" @click="addSection">Add</button>
			<button class="btn del" @click="delSection">Delete</button>
		</div>
	</div>
	<script>
		Vue.component('section-compo',{
			template: `
				<div :id="id" :class="bgColors" class="fullpage">
					<h1>{{ id }}</h1>
				</div>
			`,
			data(){
				return {
					id: null,
					bgColors: ['green', 'coral', 'blue', 'purple']
				}
			},
			mounted(){
				this.id = 'section' + this._uid
				const bgLength = this.bgColors.length;
				let randomNum = Math.floor(Math.random()*bgLength);
				this.bgColors = this.bgColors[randomNum];
			}
		});
		new Vue({
			el: '#app',
			data: {
				activeIndex: 0,
				scrolled: false,
				sections:['section-compo', 'section-compo', 'section-compo'],
				scrollPosition: null,
				test: []
			},
			methods: {
				btnClick: function(e){
					let idx = e.target.parentNode.dataset.index;
					let location = document.querySelectorAll(".fullpage")[idx].offsetTop;
					window.scroll({
						top: location,
						behavior: 'smooth'
					});
				},
				addSection: function(){
					this.sections.push('section-compo');
				},
				delSection: function(){
					let sectNum = this.sections.length;
					if(sectNum == 1){
						return
					}else{
						this.sections.splice(sectNum-1, 1);
					}
				},
				pageScroll: function(){
					this.scrollPosition = window.scrollY;
					console.log(this.scrollPosition)
				},
				// VueScrollactive: function(){
				// 	var VueScrollactive = require('vue-scrollactive');
				// }
			},
			computed: {
				num: function(){
					let sectNum = this.sections.length;
					return sectNum;
				}
			},
			watch: {
				test: function(){
					let fullPage = document.querySelectorAll(".fullpage");
				let sectNum = this.sections.length;
				for(let i = 0; i < sectNum; i++){
					let sectTop = fullPage[i].offsetTop;
					this.test.push(sectTop);
					console.log(this.test);
					// fullPage[i].setAttribute('data-scroll', sectTop );
				}
				}
			},
			created: function () {
				window.addEventListener('scroll', this.pageScroll);
			},
			destroyed: function () {
				window.removeEventListener('scroll', this.pageScroll);
			},
			// mounted(){
			// 	let fullPage = document.querySelectorAll(".fullpage");
			// 	let sectNum = this.sections.length;
			// 	for(let i = 0; i < sectNum; i++){
			// 		let sectTop = fullPage[i].offsetTop;
			// 		this.test.push(sectTop);
			// 		console.log(this.test);
			// 		// fullPage[i].setAttribute('data-scroll', sectTop );
			// 	}
			// }
		});
	</script>
</body>
</html>